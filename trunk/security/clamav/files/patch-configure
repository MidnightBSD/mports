--- configure.orig	2008-09-01 15:41:18.000000000 -0300
+++ configure	2008-09-05 08:57:53.000000000 -0300
@@ -16571,7 +16571,7 @@
     ;;
 freebsd*)
     if test "$have_pthreads" = "yes"; then
-	THREAD_LIBS="-lthr"
+	THREAD_LIBS="%%PTHREAD_LIBS%%"
 	TH_SAFE="-thread-safe"
 
 cat >>confdefs.h <<\_ACEOF
@@ -16931,7 +16931,7 @@
 if test "$have_milter" = "yes"; then
 
         save_LDFLAGS="$LDFLAGS"
-	CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -lpthread"
+	CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS $THREAD_LIBS"
     if test -d /usr/lib/libmilter ; then
 	CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -L/usr/lib/libmilter"
     fi
@@ -17468,19 +17468,25 @@
     sendmailver_c=`echo $sendmailver | awk -F. '{printf $3}'`
 
 
+if echo "$sendmailver_a" | egrep -q '^[0-9]+$'; then
 cat >>confdefs.h <<_ACEOF
 #define SENDMAIL_VERSION_A $sendmailver_a
 _ACEOF
+fi
 
 
+if echo "$sendmailver_b" | egrep -q '^[0-9]+$'; then
 cat >>confdefs.h <<_ACEOF
 #define SENDMAIL_VERSION_B $sendmailver_b
 _ACEOF
+fi
 
 
+if echo "$sendmailver_c" | egrep -q '^[0-9]+$'; then
 cat >>confdefs.h <<_ACEOF
 #define SENDMAIL_VERSION_C $sendmailver_c
 _ACEOF
+fi
 
   fi
   if test "x$ac_cv_have_lresolv_r" != "xyes"; then
